!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){t.fn.extend({retract:function(e){"use strict";var r={x:5,y:5,target:">*",widthOffset:50,horizontalSize:4,autoFullColumns:!1,substractPx:1,_markstr:"bw-ui-retract"};e&&"object"==typeof e?t.extend(r,e):"number"==typeof e&&t.extend(r,{horizontalSize:e});var n=function(e,r){if(!e)return[];var n=t(this).data(),a=r-n.x*(e-1),i=(r-n.x*(e-1))/e,o=i+n.widthOffset/2,h=i-n.widthOffset/2,s=[],l=0;(e-1)*n.x+o*(e-1)>r&&(o=parseInt((r-h)/(e-1)-n.x));for(var f=0;f<e-1;f++){var u=parseInt(Math.random()*(o-h+1)+h);s.push(u),l+=u}return s.push(a-l-n.substractPx),s};return t(this).each(function(){var a=t(this),i=t.extend({},r,t(this).data()),o=t(i.target,a),h="refresh"==e?o:o.not("["+i._markstr+"]"),s=a.width(),l=parseInt(o.length/i.horizontalSize),f=[],u=0,c=[],d=parseInt(o.length/i.horizontalSize)*i.horizontalSize,g=[],z={"margin-right":i.x,"margin-bottom":i.y,"margin-top":0,"margin-left":0,float:"left"};a.data(i);for(m=0;m<o.length-d;m++)c.push(d+m);g=n.call(a,i.autoFullColumns?c.length:i.horizontalSize,s);for(m=0;m<l;m++)f=f.concat(n.call(a,i.horizontalSize,s));h.each(function(e){var r=t(this),n=t.extend({},z,{width:f[e]});(e+1)%i.horizontalSize||!e||(n["margin-right"]=0),r.css(n),-1==t.inArray(r.index(),c)&&r.attr(i._markstr,r.index())});for(var m in g){var x=t.extend({},z,{width:g[m]});m==g.length-1&&(x["margin-right"]=0),o.eq(c[m]).css(x)}var p=o.eq(0).outerHeight()+parseFloat(h.eq(0).css("margin-bottom"));u=o.length%i.horizontalSize?(o.length/i.horizontalSize+1)*p:o.length/i.horizontalSize*p,u+=parseFloat(a.css("padding-top")||0),a.css({height:u})})}})});